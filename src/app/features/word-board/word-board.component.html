<p-toast position="top-center" key="message" [baseZIndex]="5000">
  <ng-template let-message pTemplate="message">
    <div class="p-flex p-flex-column" style="flex: 1">
      <div class="p-text-center">
        <h2 style="margin: 0">{{message.summary}}</h2>
        <span [innerHTML]="message.detail"></span>
      </div>
    </div>
  </ng-template>
</p-toast>

<div class="flex flex-column layout-content h-full align-items-center" style="justify-content: space-between;
    max-width: 500px;
    margin-inline: auto;">
  <div id="board-container" class="board-container" style="position:relative;"
       [ngStyle]="{'max-width': 'calc(((' + getHeight('board-container') + 'px - 7px * ('+numberOfGuesses+' - 1)) / '+numberOfGuesses+') * '+letters+' + 7px * ('+letters+' - 1) - 20px)'}">
    <div class="fle w-full flex-column" style="position: relative;"
         [ngStyle]="{'height': 'calc(((' + getWidth('board-container') + 'px - 7px * ('+letters+' - 1)) / '+letters+') * '+numberOfGuesses+' + 7px * ('+numberOfGuesses+' - 1))'}">
      <div id="board-row-{{row}}" *ngFor="let rowGuess of guesses; let row = index" class="relative flex w-full mb-2" style="height: calc((100%  - 7px * 5) / 6)">
        <i class="fa-solid fa-book dict-icon" *ngIf="currentGuess > row"
           style="position: absolute; left: 105%; cursor: pointer"
           (click)="getDefinition(guessedWords[row])"></i>
        <div id="board-tile-{{row}}-{{col}}" class="tile" style="width: calc((100%  - 7px * 4) / 5)" [ngClass]="{
                'present': guessResults[row][col] === 'present',
                'correct': guessResults[row][col] === 'correct',
                'unused': guessResults[row][col] === 'unused',
                'unknown': guessResults[row][col] === 'unknown',
                'reveal': guessResults[row][col] !== 'unknown'}"
             *ngFor="let guess of rowGuess; let col = index">
          <span
            style="position: absolute; width: 100%; height: 100%; display: inline-flex; justify-content: center; align-items: center;">
            {{guess}}
          </span>
        </div>
      </div>
    </div>
  </div>
  <div style="width: 100%;display: flex; height: 150px; flex-direction: column; justify-content: flex-end;">
    <div *ngIf="gameState==='playing'" id="keyboard" style="width: 100%">
      <div class=""
           style="margin: 0 auto 8px; display: flex; width: 100%; touch-action: manipulation">
        <button pButton *ngFor="let key of [].constructor(10); let i = index"
                (click)="handleKeyPress(keyboardKeys[i])"
                class="letter-button {{keyboardResults[i]}}"
                label="{{keyboardKeys[i] | uppercase}}"></button>
      </div>
      <div class=""
           style="margin: 0 auto 8px; display: flex; width: 100%; touch-action: manipulation">
        <div style="flex: .5"></div>
        <button pButton *ngFor="let key of [].constructor(9); let i = index"
                (click)="handleKeyPress(keyboardKeys[i+10])"
                class="letter-button {{keyboardResults[i+10]}}"
                label="{{keyboardKeys[i+10] | uppercase}}"></button>
        <div style="flex: .5"></div>
      </div>
      <div class=""
           style="margin: 0 auto 8px; display: flex; width: 100%; touch-action: manipulation">
        <button pButton class="letter-button unknown" label="ENTER"
                (click)="handleKeyPress('enter')"
                style="flex: 1.5"></button>
        <button pButton *ngFor="let key of [].constructor(7); let i = index"
                (click)="handleKeyPress(keyboardKeys[i+19])"
                class="letter-button {{keyboardResults[i+19]}}"
                label="{{keyboardKeys[i+19] | uppercase}}"></button>
        <button pButton class="letter-button unknown" icon="fa fa-delete-left"
                (click)="handleKeyPress('backspace')" style="flex: 1.5"></button>
      </div>
    </div>
    <div style="width: 70%; margin-inline: auto;">
      <p-messages *ngIf="gameState==='lost'" severity="error">
        <ng-template pTemplate>
          <div class="p-flex p-flex-column" style="flex: 1">
            <div class="p-text-center">
              <h2 style="text-align: center; margin: 0">You Lost!</h2>
              <p style="text-align: center; margin: 0" class="mb-1">The word was <b>{{word}}</b></p>
            </div>
            <div class="p-grid p-fluid">
              <div class="p-col-6">
                <button type="button" pButton (click)="playAgain()" label="Play Again" class="p-button"></button>
              </div>
            </div>
          </div>
        </ng-template>
      </p-messages>
      <p-messages *ngIf="gameState==='won'" severity="success">
        <ng-template pTemplate>
          <div class="p-flex p-flex-column" style="flex: 1">
            <div class="p-text-center">
              <h2 style="text-align: center">You Won!</h2>
            </div>
            <div class="p-grid p-fluid">
              <div class="p-col-6">
                <button type="button" pButton (click)="playAgain()" label="Play Again" class="p-button"></button>
              </div>
            </div>
          </div>
        </ng-template>
      </p-messages>
    </div>
  </div>
</div>

